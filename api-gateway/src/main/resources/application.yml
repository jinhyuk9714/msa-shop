server:
  port: 8080

# 호환 검증은 Docker에서 SPRING_CLOUD_COMPATIBILITY_VERIFIER_ENABLED=false 로 설정
spring:
  cloud:
    gateway:
      routes:
        - id: user-service
          uri: ${USER_SERVICE_URI:http://localhost:8081}
          predicates:
            - Path=/users/**,/auth/**
        - id: product-service
          uri: ${PRODUCT_SERVICE_URI:http://localhost:8082}
          predicates:
            - Path=/products/**
        - id: order-service
          uri: ${ORDER_SERVICE_URI:http://localhost:8083}
          predicates:
            - Path=/orders/**
  application:
    name: api-gateway

# Actuator + Prometheus + Zipkin 추적
management:
  endpoints:
    web:
      exposure:
        include: health,info,prometheus
  endpoint:
    health:
      show-details: when_authorized
  tracing:
    sampling:
      probability: 1.0
  zipkin:
    tracing:
      endpoint: ${ZIPKIN_ENDPOINT:http://localhost:9411/api/v2/spans}

# JWT 검증 (user-service와 동일 secret). prod에서는 APP_JWT_SECRET env 필수.
app:
  jwt:
    secret: ${APP_JWT_SECRET:msa-shop-jwt-secret-key-at-least-32-bytes-long-for-hs256}
